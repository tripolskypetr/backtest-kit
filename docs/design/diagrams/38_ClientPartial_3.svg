<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 1212.93359375 796" style="max-width: 1212.93px; background-color: white;" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="my-svg"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"/></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="my-svg_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="my-svg_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><g class="root"><g class="clusters"><g data-look="classic" id="Operations" class="cluster"><rect height="200" width="591.93359375" y="8" x="8" style=""/><g transform="translate(265.083984375, 8)" class="cluster-label"><foreignObject height="24" width="77.765625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Operations</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph1" class="cluster"><rect height="256" width="574.90625" y="532" x="69.1015625" style=""/><g transform="translate(293.65625, 532)" class="cluster-label"><foreignObject height="24" width="125.796875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Instance Creation</p></span></div></foreignObject></g></g><g data-look="classic" id="subGraph0" class="cluster"><rect height="176" width="603.28515625" y="282" x="33.57421875" style=""/><g transform="translate(265.748046875, 282)" class="cluster-label"><foreignObject height="24" width="138.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Memoization Cache</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_PROFIT_MEMO_0" d="M99.148,135L99.148,147.167C99.148,159.333,99.148,183.667,99.148,202C99.148,220.333,99.148,232.667,99.148,245C99.148,257.333,99.148,269.667,114.562,281.83C129.976,293.993,160.804,305.985,176.218,311.981L191.632,317.978"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_LOSS_MEMO_0" d="M254.305,135L254.305,147.167C254.305,159.333,254.305,183.667,254.305,202C254.305,220.333,254.305,232.667,254.305,245C254.305,257.333,254.305,269.667,257.25,279.481C260.196,289.296,266.087,296.592,269.032,300.24L271.978,303.888"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CLEAR_MEMO_0" d="M481.205,135L467.971,147.167C454.737,159.333,428.269,183.667,415.035,202C401.801,220.333,401.801,232.667,401.801,245C401.801,257.333,401.801,269.667,398.619,279.497C395.436,289.327,389.072,296.653,385.89,300.317L382.708,303.98"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_MEMO_KEY1_0" d="M248.377,433L243.285,437.167C238.194,441.333,228.011,449.667,222.92,460C217.828,470.333,217.828,482.667,217.828,495C217.828,507.333,217.828,519.667,217.828,529.333C217.828,539,217.828,546,217.828,549.5L217.828,553"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_MEMO_KEY2_0" d="M447.008,433L455.054,437.167C463.099,441.333,479.19,449.667,487.236,460C495.281,470.333,495.281,482.667,495.281,495C495.281,507.333,495.281,519.667,495.281,529.333C495.281,539,495.281,546,495.281,549.5L495.281,553"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_KEY1_INST1_0" d="M217.828,611L217.828,615.167C217.828,619.333,217.828,627.667,217.828,635.333C217.828,643,217.828,650,217.828,653.5L217.828,657"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_KEY2_INST2_0" d="M495.281,611L495.281,615.167C495.281,619.333,495.281,627.667,495.281,635.333C495.281,643,495.281,650,495.281,653.5L495.281,657"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CLEAR_MEMO_2" d="M520.003,135L524.252,147.167C528.501,159.333,536.998,183.667,541.247,202C545.496,220.333,545.496,232.667,545.496,245C545.496,257.333,545.496,269.667,531.092,281.591C516.689,293.516,487.881,305.032,473.477,310.79L459.074,316.548"/></g><g class="edgeLabels"><g transform="translate(99.1484375, 245)" class="edgeLabel"><g transform="translate(-61.0546875, -12)" class="label"><foreignObject height="24" width="122.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>retrieve instance</p></span></div></foreignObject></g></g><g transform="translate(254.3046875, 245)" class="edgeLabel"><g transform="translate(-61.0546875, -12)" class="label"><foreignObject height="24" width="122.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>retrieve instance</p></span></div></foreignObject></g></g><g transform="translate(401.80078125, 245)" class="edgeLabel"><g transform="translate(-61.0546875, -12)" class="label"><foreignObject height="24" width="122.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>retrieve instance</p></span></div></foreignObject></g></g><g transform="translate(217.828125, 495)" class="edgeLabel"><g transform="translate(-30.0546875, -12)" class="label"><foreignObject height="24" width="60.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>first call</p></span></div></foreignObject></g></g><g transform="translate(495.28125, 495)" class="edgeLabel"><g transform="translate(-30.0546875, -12)" class="label"><foreignObject height="24" width="60.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>first call</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(545.49609375, 245)" class="edgeLabel"><g transform="translate(-62.640625, -12)" class="label"><foreignObject height="24" width="125.28125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>clear cache entry</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(325.359375, 370)" id="flowchart-MEMO-0" class="node default"><rect height="126" width="260" y="-63" x="-130" style="" class="basic label-container"/><g transform="translate(-100, -48)" style="" class="label"><rect/><foreignObject height="96" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>getPartial memoized function<br />Key: signalId:backtest<br />Key: signalId:live</p></span></div></foreignObject></g></g><g transform="translate(217.828125, 584)" id="flowchart-KEY1-1" class="node default"><rect height="54" width="224.3125" y="-27" x="-112.15625" style="" class="basic label-container"/><g transform="translate(-82.15625, -12)" style="" class="label"><rect/><foreignObject height="24" width="164.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>signal-abc123:backtest</p></span></div></foreignObject></g></g><g transform="translate(495.28125, 584)" id="flowchart-KEY2-2" class="node default"><rect height="54" width="188.953125" y="-27" x="-94.4765625" style="" class="basic label-container"/><g transform="translate(-64.4765625, -12)" style="" class="label"><rect/><foreignObject height="24" width="128.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>signal-abc123:live</p></span></div></foreignObject></g></g><g transform="translate(217.828125, 712)" id="flowchart-INST1-3" class="node default"><rect height="102" width="227.453125" y="-51" x="-113.7265625" style="" class="basic label-container"/><g transform="translate(-83.7265625, -36)" style="" class="label"><rect/><foreignObject height="72" width="167.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ClientPartial instance 1<br />backtest=true<br />signalId=abc123</p></span></div></foreignObject></g></g><g transform="translate(495.28125, 712)" id="flowchart-INST2-4" class="node default"><rect height="102" width="227.453125" y="-51" x="-113.7265625" style="" class="basic label-container"/><g transform="translate(-83.7265625, -36)" style="" class="label"><rect/><foreignObject height="72" width="167.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>ClientPartial instance 2<br />backtest=false<br />signalId=abc123</p></span></div></foreignObject></g></g><g transform="translate(99.1484375, 108)" id="flowchart-PROFIT-5" class="node default"><rect height="54" width="112.296875" y="-27" x="-56.1484375" style="" class="basic label-container"/><g transform="translate(-26.1484375, -12)" style="" class="label"><rect/><foreignObject height="24" width="52.296875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>profit()</p></span></div></foreignObject></g></g><g transform="translate(254.3046875, 108)" id="flowchart-LOSS-6" class="node default"><rect height="54" width="98.015625" y="-27" x="-49.0078125" style="" class="basic label-container"/><g transform="translate(-19.0078125, -12)" style="" class="label"><rect/><foreignObject height="24" width="38.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>loss()</p></span></div></foreignObject></g></g><g transform="translate(510.57421875, 108)" id="flowchart-CLEAR-7" class="node default"><rect height="54" width="107.75" y="-27" x="-53.875" style="" class="basic label-container"/><g transform="translate(-23.875, -12)" style="" class="label"><rect/><foreignObject height="24" width="47.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>clear()</p></span></div></foreignObject></g></g><g transform="translate(764.93359375, 108)" id="flowchart-NOTE1-24" class="node default"><rect height="150" width="260" y="-75" x="-130" style="" class="basic label-container"/><g transform="translate(-100, -60)" style="" class="label"><rect/><foreignObject height="120" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Same signalId but different<br />backtest mode = separate instances<br />Prevents state contamination</p></span></div></foreignObject></g></g><g transform="translate(1074.93359375, 108)" id="flowchart-NOTE2-25" class="node default"><rect height="126" width="260" y="-63" x="-130" style="" class="basic label-container"/><g transform="translate(-100, -48)" style="" class="label"><rect/><foreignObject height="96" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>clear() removes memoized entry<br />Prevents memory leaks<br />after signal closes</p></span></div></foreignObject></g></g></g></g></g></svg>